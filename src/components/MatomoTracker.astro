---
// src/components/MatomoTracker.astro
const matomoUrl = import.meta.env.PUBLIC_MATOMO_URL || 'https://mymatomo.darkube.app';
const siteId = import.meta.env.PUBLIC_MATOMO_SITE_ID || '1';
---

<!-- Use client:load to force Astro to include this -->
<script client:load>
  console.log('MatomoTracker: Initializing...');
  window._paq = window._paq || [];
  
  // Configuration
  _paq.push(['setTrackerUrl', '${matomoUrl}/matomo.php']);
  _paq.push(['setSiteId', '${siteId}']);
  
  // Tracking
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  
  // Script injection
  const script = document.createElement('script');
  script.src = '${matomoUrl}/matomo.js';
  script.async = true;
  script.defer = true;
  document.head.appendChild(script);
  
  console.log('MatomoTracker: Loaded successfully');
</script>
